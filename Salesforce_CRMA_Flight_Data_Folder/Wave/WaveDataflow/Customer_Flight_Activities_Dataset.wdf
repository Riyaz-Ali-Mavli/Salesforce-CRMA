["{}","{\"nodes\":{\"FORMULA6\":{\"sources\":[\"FORMULA4\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Cancellation'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type\",\"label\":\"Record Type\",\"type\":\"TEXT\"}]}},\"FORMULA13\":{\"sources\":[\"FORMULA5\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Activity'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type_Enrollment\",\"label\":\"Record Type Enrollment\",\"type\":\"TEXT\"}]}},\"FORMULA7\":{\"sources\":[\"LOAD_DATASET2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when \\\"Month\\\" = '1' then '01'\\r\\nwhen \\\"Month\\\" = '2' then '02'\\r\\nwhen \\\"Month\\\" = '3' then '03'\\r\\nwhen \\\"Month\\\" = '4' then '04'\\r\\nwhen \\\"Month\\\" = '5' then '05'\\r\\nwhen \\\"Month\\\" = '6' then '06'\\r\\nwhen \\\"Month\\\" = '7' then '07'\\r\\nwhen \\\"Month\\\" = '8' then '08'\\r\\nwhen \\\"Month\\\" = '9' then '09'\\r\\nelse \\\"Month\\\" end\",\"defaultValue\":\"\",\"precision\":2,\"name\":\"Activity_Month\",\"label\":\"Activity Month\",\"type\":\"TEXT\"}]}},\"FORMULA8\":{\"sources\":[\"DROP_FIELDS2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(\\\"Year\\\", '-', Activity_Month, '-', '01')\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Activity_Start_Month\",\"label\":\"Activity Start Month\",\"type\":\"TEXT\"}]}},\"FORMULA15\":{\"sources\":[\"FORMULA13\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when Cancellation_Month = '1' then '01'\\r\\nwhen Cancellation_Month = '2' then '02'\\r\\nwhen Cancellation_Month = '3' then '03'\\r\\nwhen Cancellation_Month = '4' then '04'\\r\\nwhen Cancellation_Month = '5' then '05'\\r\\nwhen Cancellation_Month = '6' then '06'\\r\\nwhen Cancellation_Month = '7' then '07'\\r\\nwhen Cancellation_Month = '8' then '08'\\r\\nwhen Cancellation_Month = '9' then '09'\\r\\nelse Cancellation_Month end\",\"defaultValue\":\"\",\"precision\":2,\"name\":\"Cancellation_Date_Month_To_Track_Activity\",\"label\":\"Cancellation Date Month To Track Activity\",\"type\":\"TEXT\"}]}},\"FORMULA9\":{\"sources\":[\"FORMULA8\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Activity'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type\",\"label\":\"Record Type\",\"type\":\"TEXT\"}]}},\"DROP_FIELDS0\":{\"sources\":[\"FORMULA0\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Enrollment_Month\"]},\"fields\":[]}},\"FORMULA17\":{\"sources\":[\"FORMULA15\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(Cancellation_Year, '-', Cancellation_Date_Month_To_Track_Activity, '-', '01')\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Cancellation_Date_To_Track_Activity\",\"label\":\"Cancellation Date To Track Activity\",\"type\":\"TEXT\"}]}},\"FORMULA18\":{\"sources\":[\"JOIN13\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when Date >= \\\"ActivitiesWithCustomer.Enrollment_Start_of_Month\\\" and (Date < \\\"ActivitiesWithCustomer.Cancellation_Date_To_Track_Activity\\\" or \\\"ActivitiesWithCustomer.Cancellation_Date_To_Track_Activity\\\" is null) then 'Member' else 'Non Member' end\\r\\n\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Is_customer_an_existing_member\",\"label\":\"Is customer an existing member\",\"type\":\"TEXT\"}]}},\"FORMULA2_copy0_copy0\":{\"sources\":[\"LOAD_DATASET0_copy0_copy0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(Date)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Date_Text\",\"label\":\"Date Text\",\"type\":\"TEXT\"}]}},\"JOIN11\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN10\",\"FORMULA27\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"EnrollmentDate.Loyalty_Number\",\"EnrollmentDate.Record_Type\"],\"rightQualifier\":\"CustomerWithActivity\",\"rightKeys\":[\"Loyalty_Number\",\"Record_Type_Activity\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN12\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN11\",\"TO_DATE2\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"EnrollmentDate.Loyalty_Number\",\"EnrollmentDate.Record_Type\"],\"rightQualifier\":\"ActivitiesWithCustomer\",\"rightKeys\":[\"Loyalty_Number\",\"Record_Type_Enrollment\"],\"joinType\":\"LEFT_OUTER\"}},\"DROP_FIELDS2\":{\"sources\":[\"FORMULA7\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Month\"]},\"fields\":[]}},\"DROP_FIELDS1\":{\"sources\":[\"FORMULA3\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Cancellation_Month\"]},\"fields\":[]}},\"JOIN10\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"FORMULA21\",\"FORMULA27\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"join_logic\",\"Activity_Row_Number\"],\"rightQualifier\":\"CustomerActivityData\",\"rightKeys\":[\"join_key\",\"row_number_for_join\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN13\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN12\",\"FORMULA28\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"EnrollmentDate.Loyalty_Number\",\"EnrollmentDate.Record_Type\"],\"rightQualifier\":\"ActivitiesWithCancelledCustomers\",\"rightKeys\":[\"Loyalty_Number\",\"Record_Type_Cancellation\"],\"joinType\":\"LEFT_OUTER\"}},\"OUTPUT0\":{\"sources\":[\"FORMULA18\"],\"action\":\"save\",\"parameters\":{\"measuresToCurrencies\":[],\"fields\":[],\"dataset\":{\"name\":\"Customer_Flight_Activities_Insights_Dataset\",\"label\":\"Customer Flight Activities Insights Dataset\",\"folderName\":\"SharedApp\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET2\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Month\",\"Loyalty_Number\",\"Year\",\"Points_Accumulated\",\"Total_Flights\",\"Dollar_Cost_Points_Redeemed\",\"Points_Redeemed\",\"Distance\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Customer_Flight_Activity\",\"label\":\"Customer Flight Activity\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET1\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Loyalty_Number\",\"Marital_Status\",\"City\",\"Gender\",\"Cancellation_Month\",\"Province\",\"Education\",\"Enrollment_Type\",\"Loyalty_Card\",\"Country\",\"Postal_Code\",\"Enrollment_Month\",\"Cancellation_Year\",\"Enrollment_Year\",\"Salary\",\"CLV\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Customer_Loyalty_History\",\"label\":\"Customer Loyalty History\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Start_of_Month\",\"Start_of_Year\",\"Date\",\"Start_of_Quarter\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Calendar\",\"label\":\"Calendar\",\"type\":\"analyticsDataset\"}}},\"APPEND0\":{\"sources\":[\"JOIN0\",\"JOIN1\"],\"action\":\"appendV2\",\"parameters\":{\"fieldMappings\":[{\"top\":\"Start_of_Month\",\"bottom\":\"Start_of_Month\"},{\"top\":\"Start_of_Year\",\"bottom\":\"Start_of_Year\"},{\"top\":\"Date\",\"bottom\":\"Date\"},{\"top\":\"Start_of_Quarter\",\"bottom\":\"Start_of_Quarter\"},{\"top\":\"Date_Text\",\"bottom\":\"Date_Text\"},{\"top\":\"EnrollmentDate.Loyalty_Number\",\"bottom\":\"CancellationDate.Loyalty_Number\"},{\"top\":\"EnrollmentDate.Enrollment_Year\",\"bottom\":\"CancellationDate.Cancellation_Year\"},{\"top\":\"EnrollmentDate.Enrollment_Month__c\",\"bottom\":\"CancellationDate.Cancellation_Month__c\"},{\"top\":\"EnrollmentDate.Enrollment_Start_of_Month\",\"bottom\":\"CancellationDate.Cancellation_Start_of_Month\"},{\"top\":\"EnrollmentDate.Record_Type\",\"bottom\":\"CancellationDate.Record_Type\"}]}},\"FORMULA2_copy0\":{\"sources\":[\"LOAD_DATASET0_copy0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(Date)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Date_Text\",\"label\":\"Date Text\",\"type\":\"TEXT\"}]}},\"APPEND1\":{\"sources\":[\"APPEND0\",\"JOIN2\"],\"action\":\"appendV2\",\"parameters\":{\"fieldMappings\":[{\"top\":\"Start_of_Month\",\"bottom\":\"Start_of_Month\"},{\"top\":\"Start_of_Year\",\"bottom\":\"Start_of_Year\"},{\"top\":\"Date\",\"bottom\":\"Date\"},{\"top\":\"Start_of_Quarter\",\"bottom\":\"Start_of_Quarter\"},{\"top\":\"Date_Text\",\"bottom\":\"Date_Text\"},{\"top\":\"EnrollmentDate.Loyalty_Number\",\"bottom\":\"ActivityDate.Loyalty_Number\"},{\"top\":\"EnrollmentDate.Enrollment_Year\",\"bottom\":\"ActivityDate.Year\"},{\"top\":\"EnrollmentDate.Enrollment_Month__c\",\"bottom\":\"ActivityDate.Activity_Month\"},{\"top\":\"EnrollmentDate.Enrollment_Start_of_Month\",\"bottom\":\"ActivityDate.Activity_Start_Month\"},{\"top\":\"EnrollmentDate.Record_Type\",\"bottom\":\"ActivityDate.Record_Type\"}]}},\"TO_DATE1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Cancellation_Date_To_Track_Activity\"]},\"fields\":[{\"newProperties\":{\"name\":\"Cancellation_Date_To_Track_Activity\"},\"name\":\"Cancellation_Date_To_Track_Activity_to_date\"}]},\"sources\":[\"FORMULA17\"],\"action\":\"typeCast\",\"parameters\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"format\":\"yyyy-MM-dd\",\"type\":\"DATETIME\"},\"name\":\"Cancellation_Date_To_Track_Activity_to_date\",\"label\":\"Cancellation Date To Track Activity\"},\"name\":\"Cancellation_Date_To_Track_Activity\"}]}},\"EDIT_ATTRIBUTES1\":{\"sources\":[\"EDIT_ATTRIBUTES0\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"Month__c\",\"label\":\"Month\"},\"name\":\"EnrollmentDate.Enrollment_Month__c\"}]}},\"EDIT_ATTRIBUTES0\":{\"sources\":[\"APPEND1\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"Year__c\",\"label\":\"Year\"},\"name\":\"EnrollmentDate.Enrollment_Year\"}]}},\"FORMULA0\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when Enrollment_Month = '1' then '01'\\r\\nwhen Enrollment_Month = '2' then '02'\\r\\nwhen Enrollment_Month = '3' then '03'\\r\\nwhen Enrollment_Month = '4' then '04'\\r\\nwhen Enrollment_Month = '5' then '05'\\r\\nwhen Enrollment_Month = '6' then '06'\\r\\nwhen Enrollment_Month = '7' then '07'\\r\\nwhen Enrollment_Month = '8' then '08'\\r\\nwhen Enrollment_Month = '9' then '09'\\r\\nelse Enrollment_Month end\",\"defaultValue\":\"\",\"precision\":2,\"name\":\"Enrollment_Month__c\",\"label\":\"Enrollment Month\",\"type\":\"TEXT\"}]}},\"FORMULA1\":{\"sources\":[\"DROP_FIELDS0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(Enrollment_Year, '-', Enrollment_Month__c, '-', '01')\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Enrollment_Start_of_Month\",\"label\":\"Enrollment Start of Month\",\"type\":\"TEXT\"}]}},\"EDIT_ATTRIBUTES2\":{\"sources\":[\"EDIT_ATTRIBUTES1\"],\"action\":\"schema\",\"parameters\":{\"fields\":[{\"newProperties\":{\"name\":\"Start_of_Month_Other\",\"label\":\"Start of Month Other\"},\"name\":\"EnrollmentDate.Enrollment_Start_of_Month\"}]}},\"FORMULA2\":{\"sources\":[\"LOAD_DATASET0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(Date)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Date_Text\",\"label\":\"Date Text\",\"type\":\"TEXT\"}]}},\"FORMULA3\":{\"sources\":[\"FILTER1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when Cancellation_Month = '1' then '01'\\r\\nwhen Cancellation_Month = '2' then '02'\\r\\nwhen Cancellation_Month = '3' then '03'\\r\\nwhen Cancellation_Month = '4' then '04'\\r\\nwhen Cancellation_Month = '5' then '05'\\r\\nwhen Cancellation_Month = '6' then '06'\\r\\nwhen Cancellation_Month = '7' then '07'\\r\\nwhen Cancellation_Month = '8' then '08'\\r\\nwhen Cancellation_Month = '9' then '09'\\r\\nelse Cancellation_Month end\",\"defaultValue\":\"\",\"precision\":2,\"name\":\"Cancellation_Month__c\",\"label\":\"Cancellation Month\",\"type\":\"TEXT\"}]}},\"FORMULA4\":{\"sources\":[\"DROP_FIELDS1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(Cancellation_Year, '-', Cancellation_Month__c, '-', '01')\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Cancellation_Start_of_Month\",\"label\":\"Cancellation Start of Month\",\"type\":\"TEXT\"}]}},\"FORMULA5\":{\"sources\":[\"FORMULA1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Enrollment'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type\",\"label\":\"Record Type\",\"type\":\"TEXT\"}]}},\"FORMULA25\":{\"sources\":[\"FORMULA9\"],\"action\":\"computeRelative\",\"parameters\":{\"partitionBy\":[\"Loyalty_Number\"],\"orderBy\":[{\"fieldName\":\"Activity_Start_Month\",\"direction\":\"ASC\"}],\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"row_number()\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"row_number_for_join\",\"scale\":0,\"label\":\"row number for join\",\"type\":\"NUMBER\"}]}},\"FORMULA26\":{\"sources\":[\"FORMULA25\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(Loyalty_Number, 'Activity')\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"join_key\",\"label\":\"join key\",\"type\":\"TEXT\"}]}},\"FORMULA27\":{\"sources\":[\"FORMULA26\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Enrollment'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type_Activity\",\"label\":\"Record Type Activity\",\"type\":\"TEXT\"}]}},\"FORMULA28\":{\"sources\":[\"FORMULA6\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Activity'\",\"defaultValue\":\"\",\"precision\":20,\"name\":\"Record_Type_Cancellation\",\"label\":\"Record Type Cancellation\",\"type\":\"TEXT\"}]}},\"FILTER1\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[],\"field\":\"Cancellation_Year\",\"type\":\"TEXT\",\"operator\":\"IS_NOT_NULL\"}]}},\"TO_DATE2\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Enrollment_Start_of_Month\"]},\"fields\":[{\"newProperties\":{\"name\":\"Enrollment_Start_of_Month\"},\"name\":\"Enrollment_Start_of_Month_to_date\"}]},\"sources\":[\"TO_DATE1\"],\"action\":\"typeCast\",\"parameters\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"format\":\"yyyy-MM-dd\",\"type\":\"DATETIME\"},\"name\":\"Enrollment_Start_of_Month_to_date\",\"label\":\"Enrollment Start of Month\"},\"name\":\"Enrollment_Start_of_Month\"}]}},\"FORMULA20\":{\"sources\":[\"JOIN9\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case when \\\"EnrollmentDate.Record_Type\\\" = 'Activity' then concat(\\\"EnrollmentDate.Loyalty_Number\\\", \\\"EnrollmentDate.Record_Type\\\") else null end\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"join_logic\",\"label\":\"join logic\",\"type\":\"TEXT\"}]}},\"FORMULA21\":{\"sources\":[\"FORMULA20\"],\"action\":\"computeRelative\",\"parameters\":{\"partitionBy\":[\"join_logic\"],\"orderBy\":[{\"fieldName\":\"Start_of_Month\",\"direction\":\"ASC\"}],\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"row_number()\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Activity_Row_Number\",\"scale\":0,\"label\":\"Activity Row Number\",\"type\":\"NUMBER\"}]}},\"LOAD_DATASET0_copy0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Start_of_Month\",\"Start_of_Year\",\"Date\",\"Start_of_Quarter\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Calendar\",\"label\":\"Calendar\",\"type\":\"analyticsDataset\"}}},\"JOIN1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"CancellationDate.Marital_Status\",\"CancellationDate.City\",\"CancellationDate.Gender\",\"CancellationDate.Province\",\"CancellationDate.Education\",\"CancellationDate.Enrollment_Type\",\"CancellationDate.Loyalty_Card\",\"CancellationDate.Country\",\"CancellationDate.Postal_Code\",\"CancellationDate.Enrollment_Month\",\"CancellationDate.Enrollment_Year\",\"CancellationDate.Salary\",\"CancellationDate.CLV\"]},\"fields\":[]},\"sources\":[\"FORMULA2_copy0\",\"FORMULA28\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Date_Text\"],\"rightQualifier\":\"CancellationDate\",\"rightKeys\":[\"Cancellation_Start_of_Month\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"EnrollmentDate.Marital_Status\",\"EnrollmentDate.City\",\"EnrollmentDate.Gender\",\"EnrollmentDate.Cancellation_Month\",\"EnrollmentDate.Province\",\"EnrollmentDate.Education\",\"EnrollmentDate.Enrollment_Type\",\"EnrollmentDate.Loyalty_Card\",\"EnrollmentDate.Country\",\"EnrollmentDate.Postal_Code\",\"EnrollmentDate.Cancellation_Year\",\"EnrollmentDate.Salary\",\"EnrollmentDate.CLV\"]},\"fields\":[]},\"sources\":[\"FORMULA2\",\"FORMULA5\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Date_Text\"],\"rightQualifier\":\"EnrollmentDate\",\"rightKeys\":[\"Enrollment_Start_of_Month\"],\"joinType\":\"LEFT_OUTER\"}},\"LOAD_DATASET0_copy0_copy0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Start_of_Month\",\"Start_of_Year\",\"Date\",\"Start_of_Quarter\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Calendar\",\"label\":\"Calendar\",\"type\":\"analyticsDataset\"}}},\"JOIN9\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN8\",\"FORMULA28\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"EnrollmentDate.Loyalty_Number\",\"EnrollmentDate.Record_Type\"],\"rightQualifier\":\"CancellationData\",\"rightKeys\":[\"Loyalty_Number\",\"Record_Type\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN8\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"EDIT_ATTRIBUTES2\",\"FORMULA5\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"EnrollmentDate.Loyalty_Number\",\"EnrollmentDate.Record_Type\"],\"rightQualifier\":\"CustomerEnrollmentData\",\"rightKeys\":[\"Loyalty_Number\",\"Record_Type\"],\"joinType\":\"LEFT_OUTER\"}},\"JOIN2\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ActivityDate.Points_Accumulated\",\"ActivityDate.Total_Flights\",\"ActivityDate.Dollar_Cost_Points_Redeemed\",\"ActivityDate.Points_Redeemed\",\"ActivityDate.Distance\"]},\"fields\":[]},\"sources\":[\"FORMULA2_copy0_copy0\",\"FORMULA27\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Date_Text\"],\"rightQualifier\":\"ActivityDate\",\"rightKeys\":[\"Activity_Start_Month\"],\"joinType\":\"LEFT_OUTER\"}}},\"ui\":{\"hiddenColumns\":[],\"connectors\":[{\"source\":\"LOAD_DATASET1\",\"target\":\"TRANSFORM0\"},{\"source\":\"LOAD_DATASET0\",\"target\":\"TRANSFORM1\"},{\"source\":\"TRANSFORM1\",\"target\":\"JOIN0\"},{\"source\":\"TRANSFORM0\",\"target\":\"JOIN0\"},{\"source\":\"LOAD_DATASET0_copy0\",\"target\":\"TRANSFORM1_copy0\"},{\"source\":\"TRANSFORM1_copy0\",\"target\":\"JOIN1\"},{\"source\":\"TRANSFORM0_copy0\",\"target\":\"JOIN1\"},{\"source\":\"LOAD_DATASET0_copy0_copy0\",\"target\":\"TRANSFORM1_copy0_copy0\"},{\"source\":\"LOAD_DATASET2\",\"target\":\"TRANSFORM2\"},{\"source\":\"TRANSFORM1_copy0_copy0\",\"target\":\"JOIN2\"},{\"source\":\"TRANSFORM2\",\"target\":\"JOIN2\"},{\"source\":\"JOIN0\",\"target\":\"APPEND0\"},{\"source\":\"JOIN1\",\"target\":\"APPEND0\"},{\"source\":\"APPEND0\",\"target\":\"APPEND1\"},{\"source\":\"JOIN2\",\"target\":\"APPEND1\"},{\"source\":\"APPEND1\",\"target\":\"TRANSFORM3\"},{\"source\":\"TRANSFORM8\",\"target\":\"OUTPUT0\"},{\"source\":\"TRANSFORM3\",\"target\":\"JOIN8\"},{\"source\":\"TRANSFORM0\",\"target\":\"JOIN8\"},{\"source\":\"LOAD_DATASET1\",\"target\":\"FILTER1\"},{\"source\":\"FILTER1\",\"target\":\"TRANSFORM0_copy0\"},{\"source\":\"JOIN8\",\"target\":\"JOIN9\"},{\"source\":\"TRANSFORM0_copy0\",\"target\":\"JOIN9\"},{\"source\":\"JOIN9\",\"target\":\"TRANSFORM9\"},{\"source\":\"TRANSFORM9\",\"target\":\"JOIN10\"},{\"source\":\"TRANSFORM2\",\"target\":\"JOIN10\"},{\"source\":\"JOIN10\",\"target\":\"JOIN11\"},{\"source\":\"TRANSFORM2\",\"target\":\"JOIN11\"},{\"source\":\"TRANSFORM0\",\"target\":\"TRANSFORM7\"},{\"source\":\"JOIN11\",\"target\":\"JOIN12\"},{\"source\":\"TRANSFORM7\",\"target\":\"JOIN12\"},{\"source\":\"JOIN13\",\"target\":\"TRANSFORM8\"},{\"source\":\"JOIN12\",\"target\":\"JOIN13\"},{\"source\":\"TRANSFORM0_copy0\",\"target\":\"JOIN13\"}],\"nodes\":{\"TRANSFORM0_copy0\":{\"connectors\":[{\"source\":\"FORMULA3\",\"target\":\"DROP_FIELDS1\"},{\"source\":\"DROP_FIELDS1\",\"target\":\"FORMULA4\"},{\"source\":\"FORMULA4\",\"target\":\"FORMULA6\"},{\"source\":\"FORMULA6\",\"target\":\"FORMULA28\"}],\"top\":532,\"left\":392.1,\"description\":\"\",\"label\":\"Transform 3\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA6\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA28\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"DROP_FIELDS1\":{\"label\":\"Drop Columns\"},\"FORMULA3\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA4\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"JOIN11\":{\"top\":112,\"left\":1512,\"label\":\"Join 11\",\"type\":\"JOIN\"},\"JOIN12\":{\"top\":112,\"left\":1652,\"label\":\"Join 12\",\"type\":\"JOIN\"},\"JOIN10\":{\"top\":112,\"left\":1372,\"label\":\"Join 10\",\"type\":\"JOIN\"},\"JOIN13\":{\"top\":112.6,\"left\":1792,\"label\":\"Join 13\",\"type\":\"JOIN\"},\"OUTPUT0\":{\"top\":112.6,\"left\":2072,\"label\":\"Output 0\",\"type\":\"OUTPUT\"},\"TRANSFORM7\":{\"connectors\":[{\"source\":\"FORMULA13\",\"target\":\"FORMULA15\"},{\"source\":\"FORMULA15\",\"target\":\"FORMULA17\"},{\"source\":\"FORMULA17\",\"target\":\"TO_DATE1\"},{\"source\":\"TO_DATE1\",\"target\":\"TO_DATE2\"}],\"top\":252.2,\"left\":392,\"description\":\"\",\"label\":\"Transform 11\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA13\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA15\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA17\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"TO_DATE1\":{\"label\":\"To Date\"},\"TO_DATE2\":{\"label\":\"To Date\"}}},\"LOAD_DATASET2\":{\"top\":812,\"left\":112,\"label\":\"Customer Flight Activity\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"TRANSFORM8\":{\"connectors\":[],\"top\":112.4,\"left\":1932.1,\"description\":\"\",\"label\":\"Transform 13\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA18\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"LOAD_DATASET1\":{\"top\":252,\"left\":112,\"label\":\"Customer Loyalty History\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"TRANSFORM9\":{\"connectors\":[{\"source\":\"FORMULA20\",\"target\":\"FORMULA21\"}],\"top\":112.80000000000001,\"left\":1232,\"description\":\"\",\"label\":\"Transform 12\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA20\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA21\":{\"label\":\"Formula\"}}},\"LOAD_DATASET0\":{\"top\":112,\"left\":112,\"label\":\"Calendar\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"APPEND0\":{\"top\":112,\"left\":532,\"label\":\"Append 0\",\"type\":\"APPEND\"},\"APPEND1\":{\"top\":112,\"left\":672,\"label\":\"Append 1\",\"type\":\"APPEND\"},\"TRANSFORM0\":{\"connectors\":[{\"source\":\"FORMULA0\",\"target\":\"DROP_FIELDS0\"},{\"source\":\"DROP_FIELDS0\",\"target\":\"FORMULA1\"},{\"source\":\"FORMULA1\",\"target\":\"FORMULA5\"}],\"top\":252,\"left\":252,\"label\":\"Transform 0\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS0\":{\"label\":\"Drop Columns\"},\"FORMULA0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA1\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA5\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM1\":{\"connectors\":[],\"top\":112,\"left\":252,\"label\":\"Transform 1\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA2\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM2\":{\"connectors\":[{\"source\":\"FORMULA7\",\"target\":\"DROP_FIELDS2\"},{\"source\":\"DROP_FIELDS2\",\"target\":\"FORMULA8\"},{\"source\":\"FORMULA8\",\"target\":\"FORMULA9\"},{\"source\":\"FORMULA9\",\"target\":\"FORMULA25\"},{\"source\":\"FORMULA25\",\"target\":\"FORMULA26\"},{\"source\":\"FORMULA26\",\"target\":\"FORMULA27\"}],\"top\":812,\"left\":252,\"description\":\"\",\"label\":\"Transform 5\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA7\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA25\":{\"label\":\"Formula\"},\"FORMULA8\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA26\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA9\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA27\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"DROP_FIELDS2\":{\"label\":\"Drop Columns\"}}},\"TRANSFORM3\":{\"connectors\":[{\"source\":\"EDIT_ATTRIBUTES0\",\"target\":\"EDIT_ATTRIBUTES1\"},{\"source\":\"EDIT_ATTRIBUTES1\",\"target\":\"EDIT_ATTRIBUTES2\"}],\"top\":112,\"left\":812,\"description\":\"\",\"label\":\"Transform 6\",\"type\":\"TRANSFORM\",\"graph\":{\"EDIT_ATTRIBUTES1\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES0\":{\"label\":\"Edit Attributes\"},\"EDIT_ATTRIBUTES2\":{\"label\":\"Edit Attributes\"}}},\"TRANSFORM1_copy0_copy0\":{\"connectors\":[],\"top\":672,\"left\":252,\"description\":\"\",\"label\":\"Transform 4\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA2_copy0_copy0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"FILTER1\":{\"top\":532,\"left\":252,\"label\":\"Filter 1\",\"type\":\"FILTER\"},\"TRANSFORM1_copy0\":{\"connectors\":[],\"top\":392,\"left\":252,\"description\":\"\",\"label\":\"Transform 2\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA2_copy0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"LOAD_DATASET0_copy0\":{\"top\":392,\"left\":112,\"description\":\"\",\"label\":\"Calendar\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"JOIN1\":{\"top\":392,\"left\":392.2,\"label\":\"Join 1\",\"type\":\"JOIN\"},\"JOIN0\":{\"top\":112,\"left\":392,\"label\":\"Join 0\",\"type\":\"JOIN\"},\"LOAD_DATASET0_copy0_copy0\":{\"top\":672,\"left\":112,\"description\":\"\",\"label\":\"Calendar\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"JOIN9\":{\"top\":112,\"left\":1092,\"label\":\"Join 9\",\"type\":\"JOIN\"},\"JOIN8\":{\"top\":112,\"left\":952,\"label\":\"Join 8\",\"type\":\"JOIN\"},\"JOIN2\":{\"top\":672,\"left\":392,\"label\":\"Join 2\",\"type\":\"JOIN\"}}},\"version\":\"64.0\",\"runMode\":\"full\"}"]